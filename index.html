<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kleiderspende Verein</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Hilfsklasse um Elemente auszublenden */
        .hidden-section { display: none; }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen font-sans">

    <header class="bg-teal-600 text-white p-4 shadow-md">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center">
                <div class="w-10 h-10 bg-white rounded-full text-teal-600 flex items-center justify-center font-bold mr-3">
                    KV
                </div>
                <h1 class="text-xl md:text-2xl font-bold">Kleiderspende Verein e.V.</h1>
            </div>
            <nav class="hidden md:block">
                <ul class="flex space-x-4">
                    <li><a href="#" class="hover:text-teal-200">Startseite</a></li>
                    <li><a href="#" class="hover:text-teal-200">Über uns</a></li>
                    <li><a href="#" class="font-bold border-b-2 border-white">Spenden</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto p-4 md:p-8">

        <section id="donation-form-section" class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">Kleiderspende registrieren</h2>
            
            <form id="donationForm">
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Wie möchten Sie spenden?</label>
                    <div class="flex items-center mb-2">
                        <input id="mode-office" type="radio" name="deliveryMode" value="office" class="w-4 h-4 text-teal-600" checked onchange="toggleFormFields()">
                        <label for="mode-office" class="ml-2 text-gray-700">Persönliche Übergabe (Geschäftsstelle)</label>
                    </div>
                    <div class="flex items-center">
                        <input id="mode-pickup" type="radio" name="deliveryMode" value="pickup" class="w-4 h-4 text-teal-600" onchange="toggleFormFields()">
                        <label for="mode-pickup" class="ml-2 text-gray-700">Abholung durch Sammelfahrzeug</label>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="clothesType">Art der Kleidung</label>
                        <select id="clothesType" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                            <option value="">Bitte wählen...</option>
                            <option value="Winterkleidung">Winterkleidung</option>
                            <option value="Sommerkleidung">Sommerkleidung</option>
                            <option value="Schuhe">Schuhe</option>
                            <option value="Gemischt">Gemischt</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="crisisRegion">Krisengebiet</label>
                        <select id="crisisRegion" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                            <option value="">Bitte wählen...</option>
                            <option value="Region A">Region A (Kältehilfe)</option>
                            <option value="Region B">Region B (Erdbebengebiet)</option>
                            <option value="Region C">Region C (Fluthilfe)</option>
                        </select>
                    </div>
                </div>

                <div id="address-section" class="hidden-section mb-6 border-l-4 border-teal-500 pl-4 bg-gray-50 p-4">
                    <h3 class="font-bold text-gray-700 mb-3">Abholadresse</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="zipCode">Postleitzahl (PLZ)</label>
                        <input id="zipCode" type="text" placeholder="z.B. 12345" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <p class="text-xs text-gray-500 mt-1">Hinweis: Abholung nur möglich, wenn PLZ mit '12' beginnt.</p>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="street">Straße & Hausnummer</label>
                        <input id="street" type="text" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    </div>
                </div>

                <div class="flex items-center justify-end">
                    <button type="submit" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300">
                        Spende registrieren
                    </button>
                </div>
            </form>
        </section>

        <section id="confirmation-section" class="hidden-section max-w-2xl mx-auto bg-green-50 border border-green-200 p-6 rounded-lg shadow-lg text-center">
            <div class="text-green-600 text-5xl mb-4">✓</div>
            <h2 class="text-2xl font-bold mb-4 text-green-800">Vielen Dank für Ihre Spende!</h2>
            <p class="mb-6 text-gray-700">Ihre Registrierung war erfolgreich. Hier sind Ihre Daten:</p>
            
            <div class="bg-white p-4 rounded shadow-sm text-left inline-block w-full">
                <p><strong>Art der Kleidung:</strong> <span id="conf-type"></span></p>
                <p><strong>Krisengebiet:</strong> <span id="conf-region"></span></p>
                <p><strong>Übergabeart:</strong> <span id="conf-mode"></span></p>
                <p id="conf-address-line" class="hidden-section"><strong>Abholort:</strong> <span id="conf-address"></span></p>
                <hr class="my-3">
                <p class="text-sm text-gray-500"><strong>Zeitstempel:</strong> <span id="conf-time"></span></p>
            </div>

            <button onclick="location.reload()" class="mt-6 text-teal-600 hover:text-teal-800 underline">Weitere Spende erfassen</button>
        </section>

    </main>

    <footer class="bg-gray-800 text-white p-4 mt-8">
        <div class="container mx-auto text-center text-sm">
            <p>&copy; 2025 Kleiderspende Verein e.V.</p>
            <div class="mt-2 space-x-4">
                <a href="#" class="hover:text-gray-300">Impressum</a>
                <a href="#" class="hover:text-gray-300">Datenschutz</a>
                <a href="#" class="hover:text-gray-300">Kontakt</a>
            </div>
        </div>
    </footer>

    <script>
        // Konstante für die Geschäftsstellen-PLZ (Anforderung b.h)
        // Wir nehmen an, die Geschäftsstelle hat PLZ 12xxx.
        const OFFICE_ZIP_PREFIX = "12";

        // Funktion zum Umschalten der Felder (Anforderung b.f & b.g)
        function toggleFormFields() {
            const isPickup = document.getElementById('mode-pickup').checked;
            const addressSection = document.getElementById('address-section');
            
            if (isPickup) {
                // Tailwind: 'hidden-section' Klasse entfernen
                addressSection.classList.remove('hidden-section');
                // Felder als 'required' markieren für HTML5 Validierung
                document.getElementById('zipCode').required = true;
                document.getElementById('street').required = true;
            } else {
                addressSection.classList.add('hidden-section');
                document.getElementById('zipCode').required = false;
                document.getElementById('street').required = false;
            }
        }

        // Formular Validierung und Absenden (Anforderung b.h & b.i)
        document.getElementById('donationForm').onsubmit = function(event) {
            // Verhindert das Neuladen der Seite (Standardverhalten)
            event.preventDefault(); 

            // Daten auslesen (DOM Manipulation gemäß Lektion 5)
            const clothesType = document.getElementById('clothesType').value;
            const crisisRegion = document.getElementById('crisisRegion').value;
            const isPickup = document.getElementById('mode-pickup').checked;
            
            let addressText = "Geschäftsstelle (Persönliche Übergabe)";
            
            // Validierung für Abholung (Anforderung b.h)
            if (isPickup) {
                const zip = document.getElementById('zipCode').value;
                const street = document.getElementById('street').value;

                // Logik: Prüfen ob die ersten beiden Ziffern übereinstimmen
                // Nutzung von substring gemäß JavaScript String Methoden
                if (!zip.startsWith(OFFICE_ZIP_PREFIX)) {
                    alert(`Abholung leider nicht möglich. Ihre PLZ (${zip}) liegt nicht im Einzugsgebiet (PLZ-Bereich ${OFFICE_ZIP_PREFIX}...). Bitte wählen Sie 'Persönliche Übergabe'.`);
                    return; // Abbruch der Funktion
                }
                addressText = `${street}, ${zip}`;
            }

            // Wenn wir hier sind, ist alles validiert.
            // UI aktualisieren: Formular weg, Bestätigung her.
            document.getElementById('donation-form-section').classList.add('hidden-section');
            document.getElementById('confirmation-section').classList.remove('hidden-section');

            // Daten in die Bestätigungsseite schreiben
            document.getElementById('conf-type').innerText = clothesType;
            document.getElementById('conf-region').innerText = crisisRegion;
            document.getElementById('conf-mode').innerText = isPickup ? "Abholung" : "Persönliche Übergabe";
            
            // Datum und Uhrzeit generieren
            const now = new Date();
            document.getElementById('conf-time').innerText = now.toLocaleString('de-DE');

            if (isPickup) {
                document.getElementById('conf-address-line').classList.remove('hidden-section');
                document.getElementById('conf-address').innerText = addressText;
            } else {
                document.getElementById('conf-address-line').classList.add('hidden-section');
            }
        };
    </script>
</body>
</html>
